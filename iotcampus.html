<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>WiFi Campus Dingen</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyArL2-dYikwHHPg-GpNn0bjxKryWnoHoeI"></script>

    <style type="text/css">

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .container, .container > div, .container > div #map-canvas {
            height: inherit;
        }

    </style>

    <script src="https://code.jquery.com/jquery-3.4.0.min.js" crossorigin="anonymous"></script>

    <script type="text/javascript">

        var map;
        var infoWindow = new google.maps.InfoWindow();

        function initializeMap() {
            var myOptions = {
                center: new google.maps.LatLng(52.243365, 6.853193),
                zoom: 18,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
        }

        function getAccessPoints() {
            $.getJSON({url: "https://marloes-afstuderen.jonathanj.nl/iotcampus.php"}).done(function (data) {
                for (i in data.features) {
                    var ap = data.features[i];

                    var loc = {lat: ap.geometry.coordinates[1], lng: ap.geometry.coordinates[0]};

                    var info = "Access Point: " + ap.properties.name + "<br>" +
                        "Floor: " + ap.properties.floor + "<br>" +
                        "Estimated People: " + ap.properties.estimated_people + "<br>" +
                        "Associated Clients: " + ap.properties.associated_clients + "<br>" +
                        "Unique Users: " + ap.properties.unique_users + "<br>" +
                        "Unidentified Clients: " + ap.properties.unidentified_clients;


                    var marker = new google.maps.Marker({
                        position: loc,
                        map: map,
                        title: 'Test AP'
                    });

                    marker.addListener('click', $.proxy(openInfoWindow, null, info, marker));
                }
            });
        }

        function openInfoWindow(content, marker) {
            infoWindow.close();
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
        }

        $(document).ready(function () {
            initializeMap();
            getAccessPoints();
        });

    </script>
</head>

<body>
<div class="container">
    <div>
        <div id="map-canvas"></div>
    </div>
</div>
</body>

</html>